JavaScript性能优化

JavaScript内存管理（Memory Management）：

- 内存：有可读写的单元组成，表示一片可操作空间；
- 管理：人为的去操作一片空间的申请、使用和释放
- 内存管理：开发者主要申请空间、使用空间、释放空间
- 管理流程：申请 - 使用 - 释放

JavaScript中的垃圾回收：

- JavaScript中内存管理是自动的
- 对象不再引用时被视为垃圾
- 对象不能从根上访问到时是垃圾

JavaScript中的可达对象：

- 可以访问到的对象就是可达对象
- 可达的标准就是从根出发是否能够被找到
- JavaScript中的根就可以理解为是全局变量对象

GC算法介绍：

- GC的定义与作用：GC垃圾回收机制的简写；GC可以找到内存中的垃圾、并释放和回收空间
- GC里的垃圾：程序中不再需要使用的对象，程序中不能再访问到的对象
- GC算法：
  - GC是一种机制、垃圾回收器完成具体的工作；
  - 工作的内容就是查找垃圾释放空间、回收空间
  - 算法就是工作时查找和回收所遵循的规则

常见的GC算法：

引用计数：

核心思想：设置引用数，判断当前引用数是否为0，引用计数器，引用关系改变时修改引用数字，引用数字为0时立即回收；

优点：发现垃圾时立即回收，最大限度减少程序暂停

缺点：无法回收循环引用的对象；时间开销大；资源消耗大；



标记清楚：

核心思想：分标记和清除两个阶段完成，遍历所有对象标记活动对象，遍历所有对象标记清除未标记对象，回收相应空间；

优点：可回收循环引用的对象

缺点：不能立即回收垃圾对象，空间碎片化（回收后的空间不连续）

标记整理

核心思想：标记整理可以看做是标记清除的增强，标记阶段的操作和标记清除一致，清除阶段会先执行整理，移动对象的位置，再进行清除并回收

优点：减少碎片化空间

缺点：不可立即回收

分代回收

核心思想：

优点：

缺点：



关于V8：

认识V8：一款主流的JavaScript执行引擎

V8采用即时编译（速度快）

V8内存设限（64位为1.5G，32位为800M）

V8垃圾回收策略：

采用分代回收的思想：内存分为新生代、老生代，针对不同对象采用不同算法

V8中常用GC算法：分代回收、空间复制、标记清除、标记整理、标记增量

V8如何回收新生代对象：新生代指的是存活时间较短啊的对象；

内存分配：V8内存一分为二，小空间用于存储新生代对象（32M/16M）;

新生代对象回收实现：复制算法＋标记整理  => 新生代内存区分为两个等大的内存空间，使用空间From，空闲空间To =>  活动对象存储于From空间 => 标记整理后将活动对象拷贝至To => From 与 To交换空间完成释放

回收细节说明：

拷贝过程中可能出现晋升，就是将新生代对象移动至老生代，一轮GC还存活的新生代需要晋升，To空间的使用率超过25%

V8如何回收老生代对象：